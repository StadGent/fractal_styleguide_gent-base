$timeline-border: .3rem;
$timeline-m-left-padding: .75rem;
$timeline-m-right-padding: 1.5rem;
$timeline-dd-space-between-mobile: 4.25rem;
$timeline-dd-space-between: 5.625rem;
$timeline-dt-left-padding: 0rem; // sass-lint:disable-line zero-unit
$timeline-dt-right-padding: 5.6rem;

dl.timeline {
  width: 100%;
  padding: 0;

  .timeline-slot {
    display: grid;
    position: relative;
    grid-template-areas:
    "title"
    "left";
    grid-template-rows: auto auto;
    grid-template-columns: 1fr;

    @include desktop {
      grid-template-areas:
      "title title"
      "left  right";
      grid-template-columns: 1fr 1fr;
    }

    // Timeline-slot title styling.
    &-title {
      position: relative;
      width: 100%;
      margin: .2rem 0;
      border: 0;
      background: transparent;
      line-height: 1.2;

      button {
        width: 100%;
        margin-left: -2.25rem;
        padding-left: 3rem;
        color: inherit;
        font-size: inherit;

        @include desktop {
          margin-left: -3rem;

          &::after {
            right: 100%;
            width: 2.5rem;
            height: $timeline-border;
            background-color: color(cyan-pastel);
            content: '';
            z-index: -2;
          }
        }

        &::before,
        &::after {
          position: absolute;
        }

        // +/- icon
        &::before {
          left: 0;
          min-height: 0;
          font-size: 1.2rem;
          line-height: 30.8px;
          z-index: -1;
        }
      }
    }

    &-date {
      display: block;
      width: 100%;
    }

    &-content,
    &-header {
      width: 100%;
    }

    &-content {
      &:not(.timeline-slot-content__img) {
        padding-top: $gutter-width;
      }

      .content-image {
        padding-bottom: $gutter-width;

        @include desktop {
          padding-bottom: 0;
        }
      }

      *:last-of-type {
        margin-bottom: 0;
      }
    }

    > dt {
      @extend %h3;

      position: relative;
      top: 0;
      left: 0;
      width: 100%;
      margin: 0;
      text-align: left;
      grid-area: title;

      @include desktop {
        text-align: center;
      }

      .dt-title {
        @include theme('background-color', 'color-secondary', 'timeline-dt-bg-color');

        display: inline-block;
        margin: 0;
        padding: 2px 10px;
      }
    }

    > dd {
      @include theme('border-color', 'color-primary', 'timeline-line-color');

      position: relative;
      width: 100%;
      max-width: none;
      margin: 0;
      padding: $timeline-dd-space-between-mobile calc(#{$gutter-width*.5}) $timeline-dd-space-between-mobile calc(#{$timeline-m-left-padding} + #{$timeline-m-right-padding});
      grid-area: left;

      &::after {
        @include theme('border-color', 'color-tertiary-pastel', 'timeline-line-color');

        position: absolute;
        top: 0;
        bottom: 0;
        left: $timeline-m-left-padding;
        border-left: $timeline-border solid;
        content: '';
        z-index: -2;

        @include desktop {
          left: calc(#{$timeline-dt-left-padding} - #{$timeline-border} / 2);
        }
      }

      &.active::before {
        @include theme('background-color', 'color-tertiary-pastel', 'timeline-slot-active-indicator-background');
      }

      .accordion--content {
        margin-left: 0;
      }

      // Video component styling inside a timeline-slot.
      .video-wrapper {
        position: relative;
        width: 100%;
        margin-left: 0;
        padding-bottom: 2rem;

        // Fix to add whitespace to the video top and bottom areas.
        &::before,
        &::after {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          content: '';
          z-index: z('timeline', 'video', 'background');
        }

        &::after {
          @include theme('background-color', 'color-secondary', 'timeline-slot-default-background');
        }

        .video {
          position: relative;
          padding-top: 2rem;
          border: 0;
          z-index: z('timeline', 'video', 'player');

          .audio-description {
            min-height: 2rem;
            padding-left: 3rem;

            // Dots after a video intersection.
            &::after {
              bottom: .2rem;
            }
          }
        }
      }
    }

    // Alternating timeline-slots get alternating styling (left/right).
    &:nth-child(odd) {
      > dd {
        &:nth-child(odd) {
          @include desktop {
            padding: $timeline-dd-space-between calc(#{$gutter-width*.5}) $timeline-dd-space-between calc(#{$timeline-dt-left-padding} + #{$timeline-dt-right-padding});
            grid-area: right;
          }
        }

        &:nth-child(even) {
          @include desktop {
            padding: $timeline-dd-space-between calc(#{$timeline-dt-left-padding} + #{$timeline-dt-right-padding}) $timeline-dd-space-between calc(#{$gutter-width*.5});

            &::after {
              display: none;
            }
          }
        }
      }
    }

    &:nth-child(even) {
      @include desktop {
        text-align: right;
      }

      // Timeline-slot title styling.
      .timeline-slot-title {
        button {
          @include desktop {
            justify-content: flex-end;
            margin: 0 0 0 3rem;
            padding: 0 3rem 0 0;

            // +/- icon
            &::before {
              right: 0;
              left: auto;
              margin: 0 0 0 .75rem;
              padding-right: .2em;
            }
          }
        }
      }

      > dd {
        &:nth-child(odd) {
          @include desktop {
            padding: $timeline-dd-space-between calc(#{$timeline-dt-left-padding} + #{$timeline-dt-right-padding}) $timeline-dd-space-between calc(#{$gutter-width*.5});

            .timeline-slot-title {
              button {
                &::after {
                  right: auto;
                  left: 100%;
                }
              }
            }

            &::after {
              display: none;
            }
          }
        }

        &:nth-child(even) {
          @include desktop {
            padding: $timeline-dd-space-between calc(#{$gutter-width*.5}) $timeline-dd-space-between calc(#{$timeline-dt-left-padding} + #{$timeline-dt-right-padding});
            grid-area: right;
          }
        }
      }
    }

    // First timeline-slot specific styling.
    &:first-of-type {

      // First definition description inside the first timeline-slot.
      > dd:first-of-type {
        // Fix whitespace.
        .timeline-slot-header {
          margin-top: -.4rem;
          padding-top: 0;
        }
      }

      > dt:first-of-type {
        &::before {
          content: none;
        }
      }
    }

    // Last timeline-slot last definition description specific styling.
    &:last-of-type {
      > dd {
        &:nth-child(odd),
        &:nth-child(even) {
          padding-bottom: 0;
        }
      }

      .timeline-slot-content {
        padding-bottom: $gutter-width;
      }
    }
  }
}
